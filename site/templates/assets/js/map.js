$(document).ready(function(){var e=$(".map__switcher li"),s=$(".map__group"),t=-1;o(0);var a="",i="",d="",r=$(location).attr("hash");function c(){$(".search__grid").removeClass("active"),$(".search__result").addClass("active"),$(".search__result p:first-child").text(d),$(".search__result li").removeClass("hidden"),""!=d&&$(".search__result li").addClass("hidden"),""!=a&&$('.search__result li[data-category="'+a+'"]').removeClass("hidden"),""!=i&&$('.search__result li[data-subcategory="'+i+'"]').removeClass("hidden")}function l(){d=i=a="",$(".search input").val(""),$(".search__result").removeClass("active"),$(".search__grid").addClass("active")}function n(a){if(""!=a)if("#cinema"!=a){var e=s.eq(t);$(".map__marker").removeClass("fade"),e.find('.map__marker[data-category!="'+a+'"]').addClass("fade")}else s.each(function(a){0!=$(this).find("[data-cinema]").length&&(o(a),$(this).find(".map__marker:not([data-cinema])").addClass("fade"))})}function o(a){a<0||2<a||a==t||(t=a,e.removeClass("active"),e.eq(t).addClass("active"),function(a){switch(s.removeClass("active").removeClass("hide").removeClass("second").removeClass("third"),s.eq(a).addClass("active"),a){case 0:s.eq(1).addClass("hide"),s.eq(2).addClass("hide");break;case 1:s.eq(0).addClass("second"),s.eq(2).addClass("hide");break;case 2:s.eq(0).addClass("third"),s.eq(1).addClass("second")}$(".map__marker").removeClass("visible").removeClass("fade");var e=s.eq(a).find(".map__marker"),t=500/e.length,i=0;e.each(function(a){var e=$(this);setTimeout(function(){e.closest(".map__group.active").length&&e.addClass("visible")},i),i+=t})}(t))}""!=r&&(n(r),UIkit.Utils.scrollToElement(UIkit.$($("#main-scheme"),{duration:500}))),$(".search__result li").click(function(){var a=$(this).attr("data-id"),e=$('.map__marker[data-id="'+a+'"]').closest(".map__group");o($(".map__group").index(e)),$(".map__marker").removeClass("fade"),e.find('.map__marker[data-id!="'+a+'"]').addClass("fade"),UIkit.modal("#search").hide()}),$(".search__result p:last-child").click(function(){l()}),$(".search__cell li").click(function(){a=$(this).attr("data-category"),i=$(this).attr("data-subcategory"),d=$(this).text(),c()}),$(".search input").on("input",function(){var a;""!=(a=$(this).val().toUpperCase())?(c(),$(".search__result li").each(function(){-1==$(this).text().toUpperCase().indexOf(a)&&$(this).addClass("hidden")})):l()}),$(".map__marker[data-id]").click(function(){var a=$(this).attr("data-id");$(".info").removeClass("active"),$(".info[data-id='"+a+"']").addClass("active");var e=$(".info[data-id='"+a+"'] .info__img").attr("data-bg");$(".info[data-id='"+a+"'] .info__img").css("background-image",e),UIkit.Utils.scrollToElement(UIkit.$($(".info[data-id='"+a+"']"),{duration:500}))}),$(".scheme-start__cell .about-item__link").click(function(){n($(this).attr("data-filter"))}),$(".map__catalog li:not(:first-child)").click(function(){var a=$(this).attr("data-id"),e=$('.map__marker[data-id="'+a+'"]').closest(".map__group");o($(".map__group").index(e)),$(".map__marker").removeClass("fade"),e.find('.map__marker[data-id!="'+a+'"]').addClass("fade")}),$(".map__catalog li:first-child").click(function(){n($(this).attr("data-category"))}),e.click(function(){o(e.index($(this)))})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hcC5qcyJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsInRhYnMiLCJncm91cHMiLCJhY3RpdmUiLCJDaGFuZ2VBY3RpdmUiLCJjYXRlZ29yeSIsInN1YmNhdGVnb3J5IiwidGl0bGUiLCJoYXNoIiwibG9jYXRpb24iLCJhdHRyIiwiUmVzdWx0IiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsInRleHQiLCJCYWNrIiwidmFsIiwiU2V0RmlsdGVyIiwiZmlsdGVyIiwiZ3JvdXAiLCJlcSIsImZpbmQiLCJlYWNoIiwiaSIsInRoaXMiLCJsZW5ndGgiLCJpbmRleCIsIm1hcmtlcnMiLCJkZWxheSIsInNlbGYiLCJzZXRUaW1lb3V0IiwiY2xvc2VzdCIsIlNlbGVjdEZsb29yIiwiVUlraXQiLCJVdGlscyIsInNjcm9sbFRvRWxlbWVudCIsImR1cmF0aW9uIiwiY2xpY2siLCJpZCIsIm1vZGFsIiwiaGlkZSIsIm9uIiwidG9VcHBlckNhc2UiLCJpbmRleE9mIiwiZGF0YV9iZyIsImNzcyJdLCJtYXBwaW5ncyI6IkFBQUFBLEVBQUVDLFVBQVVDLE1BQU0sV0FDaEIsSUFBSUMsRUFBT0gsRUFBRSxxQkFDVEksRUFBU0osRUFBRSxlQUNYSyxHQUFVLEVBQ2RDLEVBQWEsR0FDYixJQUFJQyxFQUFXLEdBQ1hDLEVBQWMsR0FDZEMsRUFBTSxHQUVOQyxFQUFPVixFQUFFVyxVQUFVQyxLQUFLLFFBTTVCLFNBQVNDLElBQ1BiLEVBQUUsaUJBQWlCYyxZQUFZLFVBQy9CZCxFQUFFLG1CQUFtQmUsU0FBUyxVQUM5QmYsRUFBRSxpQ0FBaUNnQixLQUFLUCxHQUN4Q1QsRUFBRSxzQkFBc0JjLFlBQVksVUFDekIsSUFBUEwsR0FDRlQsRUFBRSxzQkFBc0JlLFNBQVMsVUFFckIsSUFBVlIsR0FDRlAsRUFBRSxxQ0FBcUNPLEVBQVMsTUFBTU8sWUFBWSxVQUNuRCxJQUFiTixHQUNGUixFQUFFLHdDQUF3Q1EsRUFBWSxNQUFNTSxZQUFZLFVBRTVFLFNBQVNHLElBR1BS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QUFNZCxLQUFLLFdBQ3RCWixFQUFFLFNBQVNjLFlBQVksVUFDdkJkLEVBQUUsa0JBQWtCd0MsRUFBRyxNQUFNekIsU0FBUyxVQUN0QyxJQUFJK0IsRUFBVTlDLEVBQUUsa0JBQWtCd0MsRUFBRyxpQkFBaUI1QixLQUFLLFdBQzNEWixFQUFFLGtCQUFrQndDLEVBQUcsaUJBQWlCTyxJQUFJLG1CQUFtQkQsR0FDL0RYLE1BQU1DLE1BQU1DLGdCQUFnQkYsTUFBTW5DLEVBQUVBLEVBQUUsa0JBQWtCd0MsRUFBRyxNQUFPLENBQUVGLFNBQVUsU0FFaEZ0QyxFQUFFLHlDQUF5Q3VDLE1BQU0sV0FFL0NwQixFQURhbkIsRUFBRTBCLE1BQU1kLEtBQUssa0JBRzVCWixFQUFFLHNDQUFzQ3VDLE1BQU0sV0FDNUMsSUFBSUMsRUFBS3hDLEVBQUUwQixNQUFNZCxLQUFLLFdBQ2xCUyxFQUFRckIsRUFBRSx5QkFBeUJ3QyxFQUFHLE1BQU1QLFFBQVEsZUFFeEQzQixFQURZTixFQUFFLGVBQWU0QixNQUFNUCxJQUVuQ3JCLEVBQUUsZ0JBQWdCYyxZQUFZLFFBQzlCTyxFQUFNRSxLQUFLLDBCQUEwQmlCLEVBQUcsTUFBTXpCLFNBQVMsVUFFekRmLEVBQUUsZ0NBQWdDdUMsTUFBTSxXQUV0Q3BCLEVBRFVuQixFQUFFMEIsTUFBTWQsS0FBSyxvQkF3RHpCVCxFQUFLb0MsTUFBTSxXQUNUakMsRUFBYUgsRUFBS3lCLE1BQU01QixFQUFFMEIiLCJmaWxlIjoibWFwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXtcclxuICB2YXIgdGFicyA9ICQoJy5tYXBfX3N3aXRjaGVyIGxpJyk7XHJcbiAgdmFyIGdyb3VwcyA9ICQoJy5tYXBfX2dyb3VwJyk7XHJcbiAgdmFyIGFjdGl2ZSA9IC0xO1xyXG4gIENoYW5nZUFjdGl2ZSgwKTtcclxuICB2YXIgY2F0ZWdvcnkgPSBcIlwiO1xyXG4gIHZhciBzdWJjYXRlZ29yeSA9IFwiXCI7XHJcbiAgdmFyIHRpdGxlPVwiXCI7XHJcblxyXG4gIHZhciBoYXNoID0gJChsb2NhdGlvbikuYXR0cignaGFzaCcpO1xyXG4gIGlmIChoYXNoIT1cIlwiKSB7XHJcbiAgICBTZXRGaWx0ZXIoaGFzaCk7XHJcbiAgICBVSWtpdC5VdGlscy5zY3JvbGxUb0VsZW1lbnQoVUlraXQuJCgkKFwiI21haW4tc2NoZW1lXCIpLCB7IGR1cmF0aW9uOiA1MDAgfSkpO1xyXG4gIH1cclxuICAvL9GA0LDQsdC+0YLQsCDRgSDQuNC90L/Rg9GC0L7QvFxyXG4gIGZ1bmN0aW9uIFJlc3VsdCgpIHtcclxuICAgICQoJy5zZWFyY2hfX2dyaWQnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAkKCcuc2VhcmNoX19yZXN1bHQnKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAkKCcuc2VhcmNoX19yZXN1bHQgcDpmaXJzdC1jaGlsZCcpLnRleHQodGl0bGUpO1xyXG4gICAgJCgnLnNlYXJjaF9fcmVzdWx0IGxpJykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xyXG4gICAgaWYgKHRpdGxlIT1cIlwiKSB7XHJcbiAgICAgICQoJy5zZWFyY2hfX3Jlc3VsdCBsaScpLmFkZENsYXNzKCdoaWRkZW4nKTtcclxuICAgIH1cclxuICAgIGlmIChjYXRlZ29yeSE9XCJcIilcclxuICAgICAgJCgnLnNlYXJjaF9fcmVzdWx0IGxpW2RhdGEtY2F0ZWdvcnk9XCInK2NhdGVnb3J5KydcIl0nKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XHJcbiAgICBpZiAoc3ViY2F0ZWdvcnkhPVwiXCIpXHJcbiAgICAgICQoJy5zZWFyY2hfX3Jlc3VsdCBsaVtkYXRhLXN1YmNhdGVnb3J5PVwiJytzdWJjYXRlZ29yeSsnXCJdJykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xyXG4gIH1cclxuICBmdW5jdGlvbiBCYWNrKCkge1xyXG4gICAgY2F0ZWdvcnk9XCJcIjtcclxuICAgIHN1YmNhdGVnb3J5PVwiXCI7XHJcbiAgICB0aXRsZT1cIlwiO1xyXG4gICAgJCgnLnNlYXJjaCBpbnB1dCcpLnZhbChcIlwiKTtcclxuICAgICQoJy5zZWFyY2hfX3Jlc3VsdCcpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICQoJy5zZWFyY2hfX2dyaWQnKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgfVxyXG4gIGZ1bmN0aW9uIElucHV0KHZhbCkge1xyXG4gICAgaWYgKHZhbCE9XCJcIikge1xyXG4gICAgICBSZXN1bHQoKTtcclxuICAgICAgJCgnLnNlYXJjaF9fcmVzdWx0IGxpJykuZWFjaChmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciBzdHIgPSAkKHRoaXMpLnRleHQoKS50b1VwcGVyQ2FzZSgpO1xyXG4gICAgICAgIGlmIChzdHIuaW5kZXhPZih2YWwpPT0tMSkgJCh0aGlzKS5hZGRDbGFzcygnaGlkZGVuJylcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIEJhY2soKTtcclxuICB9XHJcbiAgJCgnLnNlYXJjaF9fcmVzdWx0IGxpJykuY2xpY2soZnVuY3Rpb24oKXtcclxuICAgIHZhciBpZCA9ICQodGhpcykuYXR0cignZGF0YS1pZCcpO1xyXG4gICAgdmFyIGdyb3VwID0gJCgnLm1hcF9fbWFya2VyW2RhdGEtaWQ9XCInK2lkKydcIl0nKS5jbG9zZXN0KCcubWFwX19ncm91cCcpO1xyXG4gICAgdmFyIGluZGV4ID0gJCgnLm1hcF9fZ3JvdXAnKS5pbmRleChncm91cCk7XHJcbiAgICBDaGFuZ2VBY3RpdmUoaW5kZXgpO1xyXG4gICAgJCgnLm1hcF9fbWFya2VyJykucmVtb3ZlQ2xhc3MoJ2ZhZGUnKTtcclxuICAgIGdyb3VwLmZpbmQoJy5tYXBfX21hcmtlcltkYXRhLWlkIT1cIicraWQrJ1wiXScpLmFkZENsYXNzKCdmYWRlJyk7XHJcbiAgICBVSWtpdC5tb2RhbChcIiNzZWFyY2hcIikuaGlkZSgpO1xyXG4gIH0pO1xyXG4gICQoJy5zZWFyY2hfX3Jlc3VsdCBwOmxhc3QtY2hpbGQnKS5jbGljayhmdW5jdGlvbigpe1xyXG4gICAgQmFjaygpO1xyXG4gIH0pO1xyXG4gICQoJy5zZWFyY2hfX2NlbGwgbGknKS5jbGljayhmdW5jdGlvbigpe1xyXG4gICAgY2F0ZWdvcnkgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtY2F0ZWdvcnknKTtcclxuICAgIHN1YmNhdGVnb3J5ID0gJCh0aGlzKS5hdHRyKCdkYXRhLXN1YmNhdGVnb3J5Jyk7XHJcbiAgICB0aXRsZSA9ICQodGhpcykudGV4dCgpO1xyXG4gICAgUmVzdWx0KCk7XHJcbiAgfSk7XHJcbiAgJCgnLnNlYXJjaCBpbnB1dCcpLm9uKCdpbnB1dCcsZnVuY3Rpb24oKSB7XHJcbiAgICBJbnB1dCgkKHRoaXMpLnZhbCgpLnRvVXBwZXJDYXNlKCkpO1xyXG4gIH0pO1xyXG4gICQoJy5tYXBfX21hcmtlcltkYXRhLWlkXScpLmNsaWNrKGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgaWQgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtaWQnKTtcclxuICAgICQoXCIuaW5mb1wiKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAkKFwiLmluZm9bZGF0YS1pZD0nXCIraWQrXCInXVwiKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICB2YXIgZGF0YV9iZyA9ICQoXCIuaW5mb1tkYXRhLWlkPSdcIitpZCtcIiddIC5pbmZvX19pbWdcIikuYXR0cihcImRhdGEtYmdcIik7XHJcbiAgICAkKFwiLmluZm9bZGF0YS1pZD0nXCIraWQrXCInXSAuaW5mb19faW1nXCIpLmNzcygnYmFja2dyb3VuZC1pbWFnZScsZGF0YV9iZyk7XHJcbiAgICBVSWtpdC5VdGlscy5zY3JvbGxUb0VsZW1lbnQoVUlraXQuJCgkKFwiLmluZm9bZGF0YS1pZD0nXCIraWQrXCInXVwiKSwgeyBkdXJhdGlvbjogNTAwIH0pKTtcclxuICB9KTtcclxuICAkKCcuc2NoZW1lLXN0YXJ0X19jZWxsIC5hYm91dC1pdGVtX19saW5rJykuY2xpY2soZnVuY3Rpb24oKXtcclxuICAgIHZhciBmaWx0ZXIgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtZmlsdGVyJyk7XHJcbiAgICBTZXRGaWx0ZXIoZmlsdGVyKTtcclxuICB9KTtcclxuICAkKCcubWFwX19jYXRhbG9nIGxpOm5vdCg6Zmlyc3QtY2hpbGQpJykuY2xpY2soZnVuY3Rpb24oKXtcclxuICAgIHZhciBpZCA9ICQodGhpcykuYXR0cignZGF0YS1pZCcpO1xyXG4gICAgdmFyIGdyb3VwID0gJCgnLm1hcF9fbWFya2VyW2RhdGEtaWQ9XCInK2lkKydcIl0nKS5jbG9zZXN0KCcubWFwX19ncm91cCcpO1xyXG4gICAgdmFyIGluZGV4ID0gJCgnLm1hcF9fZ3JvdXAnKS5pbmRleChncm91cCk7XHJcbiAgICBDaGFuZ2VBY3RpdmUoaW5kZXgpO1xyXG4gICAgJCgnLm1hcF9fbWFya2VyJykucmVtb3ZlQ2xhc3MoJ2ZhZGUnKTtcclxuICAgIGdyb3VwLmZpbmQoJy5tYXBfX21hcmtlcltkYXRhLWlkIT1cIicraWQrJ1wiXScpLmFkZENsYXNzKCdmYWRlJyk7XHJcbiAgfSk7XHJcbiAgJCgnLm1hcF9fY2F0YWxvZyBsaTpmaXJzdC1jaGlsZCcpLmNsaWNrKGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgY2F0ID0gJCh0aGlzKS5hdHRyKCdkYXRhLWNhdGVnb3J5Jyk7XHJcbiAgICBTZXRGaWx0ZXIoY2F0KTtcclxuICB9KTtcclxuICBmdW5jdGlvbiBTZXRGaWx0ZXIoZmlsdGVyKSB7XHJcbiAgICBpZiAoZmlsdGVyPT1cIlwiKSByZXR1cm47XHJcbiAgICBpZiAoZmlsdGVyPT1cIiNjaW5lbWFcIikge1xyXG4gICAgICBncm91cHMuZWFjaChmdW5jdGlvbihpKXtcclxuICAgICAgICBpZiAoJCh0aGlzKS5maW5kKFwiW2RhdGEtY2luZW1hXVwiKS5sZW5ndGghPTApIHtcclxuICAgICAgICAgIENoYW5nZUFjdGl2ZShpKTtcclxuICAgICAgICAgICQodGhpcykuZmluZCgnLm1hcF9fbWFya2VyOm5vdChbZGF0YS1jaW5lbWFdKScpLmFkZENsYXNzKCdmYWRlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdmFyIGdyb3VwID0gZ3JvdXBzLmVxKGFjdGl2ZSk7XHJcbiAgICAkKCcubWFwX19tYXJrZXInKS5yZW1vdmVDbGFzcygnZmFkZScpO1xyXG4gICAgZ3JvdXAuZmluZCgnLm1hcF9fbWFya2VyW2RhdGEtY2F0ZWdvcnkhPVwiJytmaWx0ZXIrJ1wiXScpLmFkZENsYXNzKCdmYWRlJyk7XHJcbiAgfVxyXG4gIGZ1bmN0aW9uIENoYW5nZUFjdGl2ZShpbmRleCkge1xyXG4gICAgaWYgKGluZGV4PDAgfHwgaW5kZXg+MiB8fCBpbmRleD09YWN0aXZlKSByZXR1cm47XHJcbiAgICBhY3RpdmUgPSBpbmRleDtcclxuICAgIHRhYnMucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgdGFicy5lcShhY3RpdmUpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgIFNlbGVjdEZsb29yKGFjdGl2ZSk7XHJcbiAgfVxyXG4gIGZ1bmN0aW9uIFNlbGVjdEZsb29yKGluZGV4KSB7XHJcbiAgICBncm91cHMucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpLnJlbW92ZUNsYXNzKCdoaWRlJykucmVtb3ZlQ2xhc3MoJ3NlY29uZCcpLnJlbW92ZUNsYXNzKCd0aGlyZCcpO1xyXG4gICAgZ3JvdXBzLmVxKGluZGV4KS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICBzd2l0Y2ggKGluZGV4KSB7XHJcbiAgICAgIGNhc2UgMDpcclxuICAgICAgICBncm91cHMuZXEoMSkuYWRkQ2xhc3MoJ2hpZGUnKTtcclxuICAgICAgICBncm91cHMuZXEoMikuYWRkQ2xhc3MoJ2hpZGUnKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAxOlxyXG4gICAgICAgIGdyb3Vwcy5lcSgwKS5hZGRDbGFzcygnc2Vjb25kJyk7XHJcbiAgICAgICAgZ3JvdXBzLmVxKDIpLmFkZENsYXNzKCdoaWRlJyk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgMjpcclxuICAgICAgICBncm91cHMuZXEoMCkuYWRkQ2xhc3MoJ3RoaXJkJyk7XHJcbiAgICAgICAgZ3JvdXBzLmVxKDEpLmFkZENsYXNzKCdzZWNvbmQnKTtcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuICAgICQoJy5tYXBfX21hcmtlcicpLnJlbW92ZUNsYXNzKCd2aXNpYmxlJykucmVtb3ZlQ2xhc3MoJ2ZhZGUnKTtcclxuICAgIHZhciBtYXJrZXJzID0gZ3JvdXBzLmVxKGluZGV4KS5maW5kKFwiLm1hcF9fbWFya2VyXCIpO1xyXG4gICAgdmFyIGRlbGF5ID0gNTAwLjAvbWFya2Vycy5sZW5ndGg7XHJcbiAgICB2YXIgaSA9IDA7XHJcbiAgICBtYXJrZXJzLmVhY2goZnVuY3Rpb24oaW5kZXgpe1xyXG4gICAgICB2YXIgc2VsZiA9ICQodGhpcyk7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICBpZiAoc2VsZi5jbG9zZXN0KCcubWFwX19ncm91cC5hY3RpdmUnKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgc2VsZi5hZGRDbGFzcygndmlzaWJsZScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sIGkpO1xyXG4gICAgICAgIGkrPWRlbGF5O1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIHRhYnMuY2xpY2soZnVuY3Rpb24oKXtcclxuICAgIENoYW5nZUFjdGl2ZSh0YWJzLmluZGV4KCQodGhpcykpKTtcclxuICB9KTtcclxufSk7Il19
